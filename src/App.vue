<template>
  <div>
    <h1>üò±üò±üò± –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –∞–≤–∏—Ç–æ üò±üò±üò±</h1>
    <h2>–ó–∞–≥—Ä—É–∑–∏ —Ñ–∞–π–ª —Ñ–æ—Ä–º–∞—Ç–∞ .xlsx</h2>
    <input type="file" @change="handleFileUpload" accept=".xlsx" />
    <button @click="exportToExcel" :disabled="!processedData.length">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–∞–π–ª</button>
  </div>
</template>

<script>
import * as XLSX from 'xlsx';

export default {
  data() {
    return {
      processedData: [],
    };
  },
  methods: {
    handleFileUpload(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        const jsonData = XLSX.utils.sheet_to_json(worksheet);

        this.generateDescriptions(jsonData);
      };
      reader.readAsArrayBuffer(file);
    },
    priceCheck(desc) {
      return desc.match(/\/ ?1 –∫–≥/) ? '<p>–¶–µ–Ω–∞ —É–∫–∞–∑–∞–Ω–∞ –∑–∞ 1 –∫–≥</p>' : '';
    },
    storageConditions(cat) {
      switch (cat) {
        case '–†—ã–±–∞ –æ—Ö–ª–∞–∂–¥–µ–Ω–Ω–∞—è':
          return '<strong>–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong> 3 —Å—É—Ç–æ–∫ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ 5–°. –ù–µ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—Ç—å'
        case '–†—ã–±–∞ —Å–≤–µ–∂–µ–º–æ—Ä–æ–∂–µ–Ω–∞—è':
          return '<strong>–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong> –•—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏ -18¬∞C –∏ –Ω–∏–∂–µ, –≥–æ—Ç–æ–≤–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Ä–∞–∑–º–æ—Ä–æ–∑–∫–∏. –ü–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—Ç—å'
        case '–†—ã–±–∞ –∫–æ–ø—á–µ–Ω–∞—è':
          return '<strong>–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong> 30 —Å—É—Ç–æ–∫ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –æ—Ç 0–° –¥–æ +5–°'
        case '–†—ã–±–∞ —Å–ª–∞–±–æ—Å–æ–ª—ë–Ω–∞—è':
          return '<strong>–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong> –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è: –æ—Ç -3 –¥–æ +6 ¬∞C. –£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è: –ü–æ—Å–ª–µ –≤—Å–∫—Ä—ã—Ç–∏—è —É–ø–∞–∫–æ–≤–∫–∏ –ø—Ä–æ–¥—É–∫—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –æ—Ç +2¬∞–° –¥–æ +7¬∞C –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤.'
        case '–í–æ–¥–æ—Ä–æ—Å–ª–∏':
        case '–ì—Ä–µ–±–µ—à–æ–∫':
        case '–ö–∞–ª—å–º–∞—Ä':
        case '–ö—Ä–µ–≤–µ—Ç–∫–∏':
        case '–ö—Ä–∞–±':
        case '–ú–∏–¥–∏–∏':
        case '–ú–æ—Ä—Å–∫–æ–π –∫–æ–∫—Ç–µ–π–ª—å':
        case '–û—Å—å–º–∏–Ω–æ–≥':
          return '<strong>–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong> 12 –º–µ—Å—è—Ü–µ–≤ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ -18–°. –ü–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—Ç—å.'
        case '–ò–∫—Ä–∞ –∫—Ä–∞—Å–Ω–∞—è':
        case '–ú–∞—Å–∞–≥–æ (–ú–æ–π–≤—ã)':
        case '–¢–æ–±–∏–∫–æ (–õ–µ—Ç—É—á–µ–π —Ä—ã–±—ã)':
        case '–ú–∞—Å–ª–æ —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ':
          return '<strong>–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:</strong> 12 –º–µ—Å—è—Ü–µ–≤'
        default:
          return ''
      }
    },

    generateDescriptions(data) {
      this.processedData = data.map((item) => ({
        description: `
          <p><strong>${item.title}. ${!this.priceCheck(item.description) ? item.description : ''}</strong></p>
          ${this.priceCheck(item.description)}
          <p>
              <strong>–°—Ç—Ä–∞–Ω–∞:</strong> ${item.country}<br />
              ${!!item.characteristics
                ? '<strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong>' + item.characteristics + '<br />' 
                : ''}
              ${this.storageConditions(item.category)}
          </p>
          <p><br /></p>
          <p><strong>–°–∫–∏–¥–∫–∏!</strong></p>
          <p>üòç –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑ –Ω–∞ —Å–∞–π—Ç–µ –ì–ª–∞–≤–∫—É—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–ø—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏—Ç–µ –ì–ª–∞–≤–∫—É—Å –≤ –ø–æ–∏—Å–∫–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –Ø–Ω–¥–µ–∫—Å–∞ –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –ø–µ—Ä–≤–æ–π —Å—Å—ã–ª–∫–µ):</p>
          <p>
              ‚Ä¢ –ü–æ–ª—É—á–∏—Ç–µ —Å–∫–∏–¥–∫—É –≤ 5% –Ω–∞ –≤–µ—Å—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 15000 —Ä—É–±;<br />
              ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 10000 —Ä—É–±;<br />
              ‚Ä¢ –°–∫–∏–¥–∫–∞ 5% –Ω–∞ –ª—é–±—ã–µ —Ç–æ–≤–∞—Ä—ã –≤ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–µ –ø–æ –ø—Ä–æ–º–æ–∫–æ–¥—É (–ø—Ä–æ–º–æ–∫–æ–¥ –≤—ã—Å—ã–ª–∞–µ—Ç—Å—è –≤–∞–º –Ω–∞ –ø–æ—á—Ç—É –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ –ª—é–±–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –Ω–∞—à–µ–º —Å–∞–π—Ç–µ);
          </p>
          <p>–ü—Ä–æ–º–æ–∫–æ–¥—ã –≤–≤–æ–¥—è—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ –ì–ª–∞–≤–∫—É—Å –≤ –æ–∫–Ω–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.</p>
          <p><br /></p>
          <p><strong>–í–Ω–∏–º–∞–Ω–∏–µ!</strong> –ê–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –¥–æ 1 —è–Ω–≤–∞—Ä—è, –ø–æ—Å–ø–µ—à–∏—Ç–µ!</p>
          <p>ü§ù –ü—Ä–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ —Å –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ. –ï—Å–ª–∏ –≤ –¥–µ–Ω—å –æ—Ç–≥—Ä—É–∑–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ —Å–º–æ–≥ –¥–æ –≤–∞—Å –¥–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –∑–∞–∫–∞–∑ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω.</p>
          <p><br /></p>
          <p><strong>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ 3000 —Ä—É–±.</strong></p>
          <p><br /></p>
          <p><strong>–î–æ—Å—Ç–∞–≤–∫–∞:</strong></p>
          <p>
              –î–æ—Å—Ç–∞–≤–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –°—É–±–±–æ—Ç—É –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ, –∫—Ä–æ–º–µ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã—Ö –¥–Ω–µ–π. –ü—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –¥–æ 16:00 –¥–æ—Å—Ç–∞–≤–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –ø–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞. –ó–∞–∫–∞–∑—ã —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ 16:00 –±—É–¥—É—Ç –¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ –¥–µ–Ω—å.
          </p>
          <p>
              ‚Ä¢ –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –≤–æ –≤—Å–µ —Ä–∞–π–æ–Ω—ã –ú–æ—Å–∫–≤—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ú–ö–ê–î - 490 —Ä—É–±<br />
              ‚Ä¢ –ó–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ú–ö–ê–î –¥–æ—Å—Ç–∞–≤–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å —Ç–∞—Ä–∏—Ñ–æ–º 40 —Ä—É–±/–∫–º.
          </p>
          <p>–°—Ç–æ–∏–º–æ—Å—Ç—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ –≤–∞—à —Ä–µ–≥–∏–æ–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º.</p>
          <p><br /></p>
          <p><br /></p>
          <p><strong>üî¥ –ì–ª–∞–≤–∫—É—Å ‚Äî –≥–ª–∞–≤–Ω—ã–µ –ø–æ –≤–∫—É—Å—É! –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ä—ã–±—ã –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç–æ–≤.</strong></p>
          <p><strong>üî¥ –û—Ñ–æ—Ä–º–ª—è–π—Ç–µ –∑–∞–∫–∞–∑ –Ω–∞ —Å–∞–π—Ç–µ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –≤—ã–≥–æ–¥–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è!</strong></p>
        `.trim(),
      }));
    },
    exportToExcel() {
      const worksheet = XLSX.utils.json_to_sheet(this.processedData);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, 'Results');
      XLSX.writeFile(workbook, '–°—É–ø–µ—Ä –æ–ø–∏—Å–∞–Ω–∏–µ.xlsx');
    },
  },
};
</script>

<style>
#app {
  max-width: 1600px !important;
}

body {
  font-family: Arial, sans-serif;
  line-height: 1.6;
}
</style>
